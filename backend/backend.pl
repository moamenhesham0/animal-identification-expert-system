animal("Elephant", "Terrestrial", "Skin", "Live Birth", 4, "No", "Herbivore", "Strength", "Vocal", "Trunk", "Diurnal").
animal("Giraffe", "Terrestrial", "Fur", "Live Birth", 4, "No", "Herbivore", "Visual", "Long Neck", "Long Neck", "Diurnal").
animal("Kangaroo", "Terrestrial", "Fur", "Live Birth", 4, "No", "Herbivore", "Kick", "Vocal", "Pouch", "Crepuscular").
animal("Platypus", "Aquatic", "Fur", "Egg-laying", 4, "No", "Carnivore", "Quiet", "Duck Bill", "Duck Bill", "Nocturnal").
animal("Bat", "Terrestrial", "Fur", "Live Birth", 2, "Yes", "Omnivore", "Flight", "Echolocation", "Wings", "Nocturnal").
animal("Penguin", "Aquatic", "Feathers", "Egg-laying", 2, "No", "Carnivore", "Social", "Swimming Flippers", "Flippers", "Diurnal").
animal("Ostrich", "Terrestrial", "Feathers", "Egg-laying", 2, "No", "Omnivore", "Speed", "Vocal", "Large Legs", "Diurnal").
animal("Cheetah", "Terrestrial", "Fur", "Live Birth", 4, "No", "Carnivore", "Speed", "Vocal", "Fast Running", "Diurnal").
animal("Sloth", "Arboreal", "Fur", "Live Birth", 4, "No", "Herbivore", "Slowness", "Quiet", "Slow Movement", "Nocturnal").
animal("Armadillo", "Terrestrial", "Armor", "Live Birth", 4, "No", "Insectivore", "Shell", "Quiet", "Armor Shell", "Nocturnal").
animal("Narwhal", "Aquatic", "Smooth Skin", "Live Birth", 0, "No", "Carnivore", "Social", "Tusk", "Tusk", "Diurnal").
animal("Chameleon", "Arboreal", "Scales", "Egg-laying", 4, "No", "Insectivore", "Camouflage", "Visual", "Color Change", "Diurnal").
animal("Octopus", "Aquatic", "Smooth Skin", "Egg-laying", 8, "No", "Carnivore", "Ink Spray", "Visual", "Tentacles", "Nocturnal").
animal("Starfish", "Aquatic", "Spiny Skin", "Egg-laying", 5, "No", "Carnivore", "Regeneration", "Chemical", "Regrowth", "Diurnal").
animal("Seahorse", "Aquatic", "Scales", "Egg-laying", 0, "No", "Carnivore", "Camouflage", "Visual", "Male Birth", "Diurnal").
animal("Jellyfish", "Aquatic", "Jelly-like", "Egg-laying", 0, "No", "Carnivore", "Toxins", "Chemical", "Tentacles", "Diurnal").
animal("Anaconda", "Aquatic", "Scales", "Egg-laying", 0, "No", "Carnivore", "Constriction", "Quiet", "Large Size", "Nocturnal").
animal("Cobra", "Terrestrial", "Scales", "Egg-laying", 0, "No", "Carnivore", "Venom", "Hissing", "Hood", "Diurnal").
animal("Owl", "Arboreal", "Feathers", "Egg-laying", 2, "Yes", "Carnivore", "Silent Flight", "Vocal", "Head Rotation", "Nocturnal").
animal("Woodpecker", "Arboreal", "Feathers", "Egg-laying", 2, "Yes", "Insectivore", "Drumming", "Sound", "Pecking", "Diurnal").
animal("Parrot", "Arboreal", "Feathers", "Egg-laying", 2, "Yes", "Herbivore", "Beak", "Vocal", "Speech Mimicry", "Diurnal").
animal("Toucan", "Arboreal", "Feathers", "Egg-laying", 2, "Yes", "Frugivore", "Beak", "Vocal", "Colorful Beak", "Diurnal").
animal("Beaver", "Terrestrial", "Fur", "Live Birth", 4, "No", "Herbivore", "Construction", "Sound", "Dam Building", "Nocturnal").
animal("Porcupine", "Terrestrial", "Quills", "Live Birth", 4, "No", "Herbivore", "Quills", "Quiet", "Sharp Spines", "Nocturnal").
animal("Skunk", "Terrestrial", "Fur", "Live Birth", 4, "No", "Omnivore", "Spray", "Chemical", "Foul Smell", "Nocturnal").
animal("Hedgehog", "Terrestrial", "Spines", "Live Birth", 4, "No", "Insectivore", "Balling", "Quiet", "Rolls Up", "Nocturnal").
animal("Frog", "Amphibious", "Smooth Skin", "Egg-laying", 4, "No", "Insectivore", "Jumping", "Vocal", "Webbed Feet", "Nocturnal").
animal("Toad", "Terrestrial", "Warty Skin", "Egg-laying", 4, "No", "Insectivore", "Poison", "Vocal", "Dry Skin", "Nocturnal").
animal("Axolotl", "Aquatic", "Smooth Skin", "Egg-laying", 4, "No", "Carnivore", "Regeneration", "Quiet", "Neoteny", "Nocturnal").
animal("Crocodile", "Aquatic", "Scales", "Egg-laying", 4, "No", "Carnivore", "Strength", "Sound", "Ambush Predator", "Nocturnal").
animal("Alligator", "Aquatic", "Scales", "Egg-laying", 4, "No", "Carnivore", "Bite", "Sound", "U-Snout", "Nocturnal").
animal("Hippopotamus", "Amphibious", "Skin", "Live Birth", 4, "No", "Herbivore", "Size", "Sound", "Semi-Aquatic", "Nocturnal").
animal("Rhino", "Terrestrial", "Skin", "Live Birth", 4, "No", "Herbivore", "Horn", "Sound", "Horn", "Diurnal").
animal("Zebra", "Terrestrial", "Fur", "Live Birth", 4, "No", "Herbivore", "Speed", "Vocal", "Stripes", "Diurnal").
animal("Lion", "Terrestrial", "Fur", "Live Birth", 4, "No", "Carnivore", "Strength", "Vocal", "Mane", "Nocturnal").
animal("Tiger", "Terrestrial", "Fur", "Live Birth", 4, "No", "Carnivore", "Stealth", "Vocal", "Stripes", "Nocturnal").
animal("Panda", "Terrestrial", "Fur", "Live Birth", 4, "No", "Herbivore", "Strength", "Vocal", "Bamboo Diet", "Diurnal").
animal("Koala", "Arboreal", "Fur", "Live Birth", 4, "No", "Herbivore", "Sleep", "Vocal", "Eucalyptus Diet", "Nocturnal").
animal("Whale", "Aquatic", "Smooth Skin", "Live Birth", 0, "No", "Carnivore", "Size", "Vocal", "Blowhole", "Diurnal").
animal("Dolphin", "Aquatic", "Smooth Skin", "Live Birth", 0, "No", "Carnivore", "Echolocation", "Vocal", "Intelligence", "Diurnal").


:- dynamic(asked/3).

% Assign weights to each criterion
weight(habitat, 2).
weight(skin_cover, 1).
weight(birth_type, 4).
weight(legs, 4).
weight(can_fly, 4).
weight(diet, 1).
weight(behavior, 1).
weight(sound, 2).
weight(special, 2).
weight(activity, 1).

% Calculate score for a single animal using all 10 criteria
animal_score(Name, Score) :-
    animal(Name, Habitat, Skin, Birth, Legs, Fly, Diet, Behavior, Sound, Special, Activity),
    score_criterion(habitat, Habitat, HScore),
    score_criterion(skin_cover, Skin, SScore),
    score_criterion(birth_type, Birth, BthScore),
    score_criterion(legs, Legs, LScore),
    score_criterion(can_fly, Fly, FScore),
    score_criterion(diet, Diet, DScore),
    score_criterion(behavior, Behavior, BScore),
    score_criterion(sound, Sound, SndScore),
    score_criterion(special, Special, SpcScore),
    score_criterion(activity, Activity, AScore),
    Score is HScore + SScore + BthScore + LScore + FScore + DScore + BScore + SndScore + SpcScore + AScore.


% Penalties for missing input per criterion
penalty(habitat, -3).
penalty(skin_cover, -1).
penalty(birth_type, -2).
penalty(legs, -2).
penalty(can_fly, -1).
penalty(diet, 0).
penalty(behavior, 0).
penalty(sound, -1).
penalty(special, 0).
penalty(activity, 0).

% Score for each criterion: full match = weight, no match = 0, not asked = penalty specific to criterion
score_criterion(Criterion, Value, Score) :-
    weight(Criterion, W),
    penalty(Criterion, Penalty),
    ( asked(user, Criterion, Input), Input \= '' ->
        (Input = Value -> Score = W ; Score = 0)
    ; Score = Penalty).

% Penalty for missing input
penalty(-1).

max_score(Matches, Max) :-
    findall(Score, member(_-Score, Matches), Scores),
    max_list(Scores, Max).

has_score(Max, _-Score) :- Score =:= Max.



recommend_animals :-
    findall(Name-Score, animal_score(Name, Score), Matches),
    max_score(Matches, Max),
    include(has_score(Max), Matches, BestMatches),
    (BestMatches = [] -> write('No animals matched.') ; print_animals(BestMatches)).

print_animals([]).
print_animals([Name-Score | Rest]) :-
    format('~w (Match score: ~w)~n', [Name, Score]),
    print_animals(Rest).


% Get unique values for a specific argument position
extract_unique(CriterionIndex, _CriterionName, UniqueList) :-
    findall(Value, (
        animal(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11),
        nth1(CriterionIndex, [A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11], Value)
    ), AllValues),
    sort(AllValues, UniqueList).







